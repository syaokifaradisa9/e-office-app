
   FAIL  Tests\Feature\Inventory\CategoryItemTest
  ✓ Permissio… 3.56s  
  ✓ Permissio… 0.19s  
  ⨯ Permissio… 0.18s  
  ⨯ Permissio… 0.25s  
  ⨯ Permissio… 0.14s  
  ⨯ Permissio… 0.14s  
  ⨯ CRUD Oper… 1.46s  
  ⨯ CRUD Oper… 1.20s  
  ⨯ CRUD Oper… 0.15s  
  ⨯ CRUD Oper… 0.15s  
  ✓ CRUD Oper… 0.16s  
  ⨯ Validasi…  1.65s  
  ⨯ Validasi…  1.36s  
  ⨯ Validasi…  1.89s  
  ⨯ Validasi…  1.13s  
  ⨯ Datatable… 0.57s  
  ✓ Datatable… 0.20s  
  ⨯ Datatable… 0.17s  
  ✓ Export Ex… 0.15s  
  ✓ Export Ex… 0.14s  
  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.

  at tests\Feature\Inventory\CategoryItemTest.php:63
     59▕             'description' => 'Updated Description',
     60▕             'is_active' => true
     61▕         ]);
     62▕         
  ➜  63▕         $response->assertForbidden();
     64▕     });
     65▕     
     66▕     it('mengizinkan menyimpan update dengan permission kelola', function () {
     67▕         $this->testRole->syncPermissions(['kelola_kategori_barang']);

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 404.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:77
     73▕             'description' => 'Updated Description',
     74▕             'is_active' => true
     75▕         ]);
     76▕         
  ➜  77▕         $response->assertRedirect('/inventory/categories');
     78▕         
     79▕         $this->assertDatabaseHas('category_items', [
     80▕             'id' => $category->id,
     81▕             'name' => 'Updated Name'

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [403] but received 404.
Failed asserting that 404 is identical to 403.

  at tests\Feature\Inventory\CategoryItemTest.php:92
     88▕         $category = CategoryItem::factory()->create();
     89▕         
     90▕         $response = $this->actingAs($this->testUser)->delete("/inventory/categories/{$category->id}");
     91▕         
  ➜  92▕         $response->assertForbidden();
     93▕     });
     94▕     
     95▕     it('mengizinkan menghapus kategori dengan permission kelola', function () {
     96▕         $this->testRole->syncPermissions(['kelola_kategori_barang']);

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 404.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:102
     98▕         $category = CategoryItem::factory()->create();
     99▕         
    100▕         $response = $this->actingAs($this->testUser)->delete("/inventory/categories/{$category->id}");
    101▕         
  ➜ 102▕         $response->assertRedirect('/inventory/categories');
    103▕         
    104▕         $this->assertDatabaseMissing('category_items', [
    105▕             'id' => $category->id
    106▕         ]);

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 405.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:123
    119▕             'description' => 'Deskripsi kategori baru',
    120▕             'is_active' => true
    121▕         ]);
    122▕         
  ➜ 123▕         $response->assertRedirect('/inventory/categories');
    124▕         
    125▕         $this->assertDatabaseHas('category_items', [
    126▕             'name' => 'Kategori Baru',
    127▕             'description' => 'Deskripsi kategori baru',

  ──────────────────  
   FAILED  Tests\F…   
  Session is missing expected key [errors].
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:143
    139▕             'description' => 'Deskripsi',
    140▕             'is_active' => true
    141▕         ]);
    142▕         
  ➜ 143▕         $response->assertSessionHasErrors('name');
    144▕     });
    145▕     
    146▕     it('dapat mengupdate kategori yang ada', function () {
    147▕         $category = CategoryItem::factory()->create([

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 404.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:158
    154▕             'description' => 'New Description',
    155▕             'is_active' => false
    156▕         ]);
    157▕         
  ➜ 158▕         $response->assertRedirect('/inventory/categories');
    159▕         
    160▕         $this->assertDatabaseHas('category_items', [
    161▕             'id' => $category->id,
    162▕             'name' => 'New Name',

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 404.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:173
    169▕         $category = CategoryItem::factory()->create();
    170▕         
    171▕         $response = $this->actingAs($this->testUser)->delete("/inventory/categories/{$category->id}");
    172▕         
  ➜ 173▕         $response->assertRedirect('/inventory/categories');
    174▕         
    175▕         $this->assertDatabaseMissing('category_items', [
    176▕             'id' => $category->id
    177▕         ]);

  ──────────────────  
   FAILED  Tests\F…   
  Session is missing expected key [errors].
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:209
    205▕             'description' => 'Deskripsi',
    206▕             'is_active' => true
    207▕         ]);
    208▕         
  ➜ 209▕         $response->assertSessionHasErrors('name');
    210▕     });
    211▕     
    212▕     it('gagal membuat kategori dengan nama melebihi batas karakter', function () {
    213▕         $longName = str_repeat('a', 256); // Assuming max is 255

  ──────────────────  
   FAILED  Tests\F…   
  Session is missing expected key [errors].
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:221
    217▕             'description' => 'Deskripsi',
    218▕             'is_active' => true
    219▕         ]);
    220▕         
  ➜ 221▕         $response->assertSessionHasErrors('name');
    222▕     });
    223▕     
    224▕     it('gagal membuat kategori dengan nama yang sudah ada (unique)', function () {
    225▕         CategoryItem::factory()->create(['name' => 'Existing Category']);

  ──────────────────  
   FAILED  Tests\F…   
  Session is missing expected key [errors].
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:233
    229▕             'description' => 'New Description',
    230▕             'is_active' => true
    231▕         ]);
    232▕         
  ➜ 233▕         $response->assertSessionHasErrors('name');
    234▕     });
    235▕     
    236▕     it('dapat membuat kategori tanpa deskripsi (optional)', function () {
    237▕         $response = $this->actingAs($this->testUser)->post('/inventory/categories', [

  ──────────────────  
   FAILED  Tests\F…   
  Expected response status code [201, 301, 302, 303, 307, 308] but received 405.
Failed asserting that false is true.

  at tests\Feature\Inventory\CategoryItemTest.php:242
    238▕             'name' => 'Kategori Tanpa Deskripsi',
    239▕             'is_active' => true
    240▕         ]);
    241▕         
  ➜ 242▕         $response->assertRedirect('/inventory/categories');
    243▕         
    244▕         $this->assertDatabaseHas('category_items', [
    245▕             'name' => 'Kategori Tanpa Deskripsi',
    246▕             'description' => null

  ──────────────────  
   FAILED  Tests\F…   
  Failed asserting that 20 is identical to 10.

  at tests\Feature\Inventory\CategoryItemTest.php:275
    271▕         
    272▕         $data = $response->json();
    273▕         expect($data['current_page'])->toBe(1);
    274▕         expect($data['total'])->toBe(25);
  ➜ 275▕         expect(count($data['data']))->toBe(10);
    276▕     });
    277▕     
    278▕     it('pencarian/filter berfungsi dengan benar', function () {
    279▕         CategoryItem::factory()->create(['name' => 'Elektronik']);

  1   tests\Feature\Inventory\CategoryItemTest.php:275

  ──────────────────  
   FAILED  Tests\F…   
  Failed asserting that two strings are identical.
--- Expected
+++ Actual
@@ @@
-'Alpha'
+'Zebra'

  at tests\Feature\Inventory\CategoryItemTest.php:302
    298▕         
    299▕         $response->assertOk();
    300▕         $data = $response->json();
    301▕         
  ➜ 302▕         expect($data['data'][0]['name'])->toBe('Alpha');
    303▕         expect($data['data'][1]['name'])->toBe('Beta');
    304▕         expect($data['data'][2]['name'])->toBe('Zebra');
    305▕     });
    306▕ });

  1   tests\Feature\Inventory\CategoryItemTest.php:302


  Tests:    14 failed, 6 passed (33 assertions)
  Duration: 15.48s

